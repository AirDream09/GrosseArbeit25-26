<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moderation Scripts</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #3d3d3d;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --accent: #6366f1;
            --accent-hover: #4f46e5;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
            --border: #404040;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--bg-secondary);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-size: 2em;
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .mode-switcher {
            display: flex;
            gap: 10px;
        }

        .mode-btn {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .main-content {
            display: flex;
            min-height: 700px;
        }

        .sidebar {
            width: 300px;
            background: var(--bg-tertiary);
            border-right: 1px solid var(--border);
            padding: 20px;
        }

        .content-area {
            flex: 1;
            padding: 20px;
        }

        /* Ordner Styles */
        .folder {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .folder:hover {
            border-color: var(--accent);
            background: var(--bg-primary);
        }

        .folder.active {
            border-color: var(--accent);
            background: var(--accent);
        }

        .folder-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .folder-name {
            font-weight: 500;
        }

        .folder-actions {
            display: flex;
            gap: 5px;
        }

        .folder-item-count {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Namen Liste Styles */
        .section-title {
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #names-list {
            min-height: 400px;
            max-height: 500px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .name-item {
            background: var(--bg-tertiary);
            margin: 10px 0;
            padding: 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .name-item:hover {
            border-color: var(--accent);
            background: var(--bg-secondary);
        }

        .name-item.selected {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .name-item-number {
            background: var(--accent);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .name-item-content {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .name-text {
            font-weight: 500;
            font-size: 16px;
        }

        .name-actions {
            display: flex;
            gap: 5px;
        }

        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            background: var(--accent-hover);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #0da271;
        }

        .btn-warning {
            background: var(--warning);
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .action-btn {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border);
            padding: 5px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        /* Audio Recorder */
        .audio-recorder {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }

        .audio-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 10px;
        }

        .recording {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 999;
        }

        .script-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-secondary);
            border: 2px solid var(--accent);
            border-radius: 15px;
            padding: 0;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            z-index: 1000;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: var(--bg-tertiary);
            padding: 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 13px 13px 0 0;
        }

        .modal-title {
            font-size: 1.5em;
            font-weight: bold;
        }

        .close-btn {
            background: var(--danger);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            padding: 25px;
            max-height: 60vh;
            overflow-y: auto;
        }

        /* Form Styles */
        .add-name-form, .folder-form {
            margin-top: 20px;
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--text-primary);
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            color: var(--text-primary);
            transition: border-color 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--accent);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .sync-status {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 10px 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .instructions {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: var(--text-secondary);
        }

        .empty-message {
            color: var(--text-secondary);
            text-align: center;
            font-style: italic;
            padding: 40px 20px;
        }

        .export-section {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid var(--success);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        /* Folder Selection Modal */
        .folder-selection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .folder-option {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .folder-option:hover {
            border-color: var(--accent);
        }

        .folder-option.selected {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        /* TXT Export Section */
        .txt-export-section {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid #3b82f6;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .txt-preview {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--border);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé§ Moderation Scripts</h1>
            <div class="mode-switcher">
                <button class="mode-btn active" onclick="switchMode('normal')">üìã Normal</button>
                <button class="mode-btn" onclick="switchMode('folder')">üìÅ Ordner</button>
            </div>
        </header>

        <div class="sync-status">
            <div>
                <span id="sync-text">Lokaler Speicher</span>
            </div>
            <button class="btn" onclick="forceSync()">üîÑ Sync</button>
        </div>

        <div class="instructions">
            <strong>üí° Anleitung:</strong> 
            <span id="mode-instructions">
                ‚Ä¢ Klicke auf Namen f√ºr Scripts ‚Ä¢ Bearbeiten mit ‚úé ‚Ä¢ Reihenfolge mit üî¢ ‚Ä¢ Ordner mit üìÅ
            </span>
        </div>

        <div class="main-content">
            <!-- Sidebar f√ºr Ordner-Modus -->
            <div class="sidebar" id="sidebar" style="display: none;">
                <h3>üìÅ Ordner</h3>
                <button class="btn btn-success" onclick="showAllFolders()" id="all-folders-btn" style="margin-bottom: 15px; width: 100%;">
                    üìã Alle Ordner anzeigen
                </button>
                <div id="folders-list">
                    <!-- Ordner werden hier dynamisch eingef√ºgt -->
                </div>
                
                <div class="folder-form">
                    <h4>Neuer Ordner</h4>
                    <div class="form-group">
                        <input type="text" id="folder-name-input" placeholder="Ordnername">
                    </div>
                    <button class="btn btn-success" onclick="createFolder()">üìÅ Ordner erstellen</button>
                </div>
            </div>

            <!-- Hauptbereich -->
            <div class="content-area">
                <div class="names-section">
                    <h2 class="section-title">
                        <span id="content-title">Personen</span>
                        <span style="font-size: 0.8em; color: var(--text-secondary);">
                            (Anzahl: <span id="person-count">0</span>)
                        </span>
                    </h2>

                    <div id="normal-controls">
                        <button class="btn btn-warning" onclick="openOrderEditor()">
                            üìã Reihenfolge bearbeiten
                        </button>
                    </div>

                    <div id="folder-controls" style="display: none;">
                        <button class="btn" onclick="showAllFolders()" id="back-to-folders">‚¨ÖÔ∏è Zur√ºck zu allen Ordnern</button>
                        <button class="btn btn-success" onclick="moveToFolder()">üìÇ In Ordner verschieben</button>
                        <button class="btn" onclick="removeFromFolder()">üì§ Aus Ordner entfernen</button>
                    </div>
                    
                    <div id="names-list">
                        <!-- Namen werden hier dynamisch eingef√ºgt -->
                    </div>

                    <!-- TXT Export Section -->
                    <div class="txt-export-section">
                        <h4>üìù TXT Export/Import</h4>
                        <div class="txt-preview" id="txt-preview">
                            <!-- TXT Vorschau wird hier angezeigt -->
                        </div>
                        <button class="btn btn-success" onclick="exportToTXT()">üìÑ Als TXT exportieren</button>
                        <button class="btn" onclick="importFromTXT()">üì• TXT importieren</button>
                        <button class="btn" onclick="showTXTPreview()">üëÅÔ∏è TXT Vorschau</button>
                    </div>

                    <!-- Export Section -->
                    <div class="export-section">
                        <h4>üìä Andere Export-Formate</h4>
                        <button class="btn btn-success" onclick="exportToExcel()">üìà Excel exportieren</button>
                        <button class="btn" onclick="exportToJSON()">üìÅ JSON Backup</button>
                        <button class="btn" onclick="importFromJSON()">üì• JSON importieren</button>
                    </div>

                    <!-- Add Person Form -->
                    <div class="add-name-form">
                        <h3 id="form-title">‚ûï Neue Person hinzuf√ºgen</h3>
                        <div class="form-group">
                            <label for="name-input">Name:</label>
                            <input type="text" id="name-input" placeholder="Name der Person">
                        </div>
                        <div class="form-group">
                            <label for="script-input">Moderation Script:</label>
                            <textarea id="script-input" placeholder="Moderationstext f√ºr diese Person..."></textarea>
                        </div>
                        <button class="btn btn-success" onclick="addPerson()" id="submit-btn">Person hinzuf√ºgen</button>
                        <button class="btn" onclick="cancelEdit()" id="cancel-btn" style="display: none;">Abbrechen</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Script Modal -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeModal()"></div>
    <div class="script-modal" id="script-modal">
        <div class="modal-header">
            <div class="modal-title" id="modal-title">Script</div>
            <button class="close-btn" onclick="closeModal()">√ó</button>
        </div>
        <div class="modal-content">
            <div id="modal-script" style="white-space: pre-wrap; line-height: 1.6; margin-bottom: 20px; padding: 15px; background: var(--bg-tertiary); border-radius: 8px;"></div>
            <div class="audio-recorder">
                <h4>üéµ Audio-Aufnahme</h4>
                <div class="audio-controls">
                    <button class="btn" id="start-record">‚è∫Ô∏è Aufnahme starten</button>
                    <button class="btn btn-danger" id="stop-record" style="display: none;">‚èπÔ∏è Stopp</button>
                    <audio id="audio-playback" controls style="display: none;"></audio>
                    <button class="btn btn-success" id="save-audio" style="display: none;">üíæ Audio speichern</button>
                </div>
                <div id="audio-list">
                    <!-- Gespeicherte Audios werden hier angezeigt -->
                </div>
            </div>
        </div>
    </div>

    <!-- Folder Selection Modal -->
    <div class="modal-overlay" id="folder-modal-overlay" onclick="closeFolderModal()"></div>
    <div class="script-modal" id="folder-modal">
        <div class="modal-header">
            <div class="modal-title" id="folder-modal-title">Zu Ordner hinzuf√ºgen</div>
            <button class="close-btn" onclick="closeFolderModal()">√ó</button>
        </div>
        <div class="modal-content">
            <p>W√§hle die Ordner aus, zu denen diese Person hinzugef√ºgt werden soll:</p>
            <div class="folder-selection" id="folder-selection">
                <!-- Ordner werden hier dynamisch eingef√ºgt -->
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-success" onclick="saveFolderSelection()">Hinzuf√ºgen</button>
                <button class="btn" onclick="closeFolderModal()">Abbrechen</button>
            </div>
        </div>
    </div>

    <script>
        // KOMPLETTE DATEN MIT ALLEN 37 NAMEN
        const DEFAULT_EXCEL_DATA = [
            { id: 1, name: "Jaden", script: "[Name hier einf√ºgen] wir wissen ja alle, das Jaden ein Riesen Taylor Swift Fan ist‚Ä¶ Die Idee seiner GA kam ihm beim H√∂ren von New Romantics von Taylor Swift bei der line: It's poker\nHe can't see it in my face\nBut I'm about to play my Ace (ah) // Pokerface Lady Gaga" },
            { id: 2, name: "Daniil", script: "Bro du bist ja vorhin mit dem Aufzug gefahren und jetzt ist der kaputt, zum Gl√ºck hat Daniil eine Treppe gebaut" },
            { id: 3, name: "Sarah", script: "Keine Rezepte mehr - Familien Gerichte von Sarah familienrezepte nachkochen dann holt euch" },
            { id: 4, name: "Alina", script: "Moderator 1: Du, sag mal, was ziehst du eigentlich zum Abschlussball an?\n\nModerator 2: Keine Ahnung, ich hab nix zum Anziehen ‚Ä¶\n\nModerator 1: Dann mach's wie Alina ‚Äì die hat ihr Kleid einfach selbst gen√§ht!" },
            { id: 5, name: "Ailis", script: "Moderator 1: Ich kann keine Hausaufgaben machen ohne Musik.\nModerator 2: Same! Zum Gl√ºck hat Ailis da was erfunden ‚Äì einen Schreibtisch mit eingebauter Musikanlage!\nModerator 1: Also Lernen mit Beat ‚Äì das w√§r endlich mal Motivation!\nModerator 2: Wenn da jetzt noch Snacks drin w√§ren, w√ºrd ich nie wieder aufstehen." },
            { id: 6, name: "Samed", script: "Moderator 1: Wei√üt du, was Samed in seiner Freizeit am liebsten macht?\n\nModerator 2: Lass mich raten: Okey spielen!\n\nModerator 1: Genau ‚Äì und weil ihm das nicht genug war, hat er einfach sein eigenes gebaut!" },
            { id: 7, name: "Maji", script: "Moderator 1: Maji wollte Fu√üball, aber ein bisschen cooler.\n\nModerator 2: Ja, also nicht nur Kicken ‚Äì sondern mit Technik!\n\nModerator 1: Deshalb hat er eine elektrische Torwand gebaut ‚Äì mit Licht und allem drum und dran." },
            { id: 8, name: "Phillip", script: "Moderator 1: Phillip hat sich gedacht: Fahrradfahren kann jeder.\n\nModerator 2: Stimmt, aber cool aussehen beim Fahren? Das ist die Kunst!\n\nModerator 1: Deswegen hat er sein Fahrrad komplett umgebaut ‚Äì Slopeduro-Style!\n\nModerator 2: Sieht so schnell aus, selbst wenn's steht. Ich glaub, ich brauch auch so eins!" },
            { id: 9, name: "Gustav", script: "Moderator 1: Kennst du die Geschichte mit dem Schachbrett und den Reisk√∂rnern?\n\nModerator 2: √Ñh‚Ä¶ nein, aber klingt kompliziert.\n\nModerator 1: Egal, Gustav hat wenigstens das Schachbrett gebaut ‚Äì und das reicht v√∂llig.\n\nModerator 2: Ja, und gegen ihn zu gewinnen, ist wahrscheinlich schwerer als Mathe." },
            { id: 10, name: "Julius", script: "Moderator 1: Ich brauch mal wieder Bewegung.\n\nModerator 2: Dann geh zu Julius! Der hat n√§mlich ein richtig cooles Parcours-Hindernis gebaut.\n\nModerator 1: Also rennen, springen, klettern ‚Äì alles erlaubt!" },
            { id: 11, name: "Lea", script: "Moderator 1: Wenn du an Street-Art denkst, denkst du an Lea!\n\nModerator 2: Sie hat n√§mlich eine Graffiti-Holzplatte mit eigenem Design gemacht.\n\nModerator 1: Farben, Bubbles, Style ‚Äì alles drin!\n\nModerator 2: Banksy w√§re neidisch, sag ich dir." },
            { id: 12, name: "Julia", script: "Moderator 1: Julia hatte morgens immer ein Problem.\n\nModerator 2: Zu wenig Platz f√ºr Schminke?\n\nModerator 1: Genau ‚Äì also hat sie sich einfach ihren eigenen Schminktisch gebaut.\n\nModerator 2: Stylisch UND praktisch ‚Äì das nenn ich Selbsthilfe!" },
            { id: 13, name: "Anna", script: "Moderator 1: Monopoly ist dir zu langweilig?\n\nModerator 2: Total ‚Äì aber Anna hat's magischer gemacht!\n\nModerator 1: Mit Zauberspr√ºchen, Hogwarts und W√ºrfeln voller Magie!\n\nModerator 2: Ich hoffe, man kann da nicht in Askaban landen, statt ins Gef√§ngnis." },
            { id: 14, name: "Mathilda", script: "Moderator 1: Mathilda hat beim Umzug festgestellt: Es fehlt was!\n\nModerator 2: Lass mich raten ‚Äì ein Couchtisch?\n\nModerator 1: Genau. Also hat sie einfach selbst einen gegossen ‚Äì mit Epoxidharz!\n\nModerator 2: Gl√§nzend, stylisch und wahrscheinlich teurer als meiner zuhause." },
            { id: 15, name: "Emma", script: "Moderator 1: Dir ist kalt?\n\nModerator 2: Immer!\n\nModerator 1: Kein Problem ‚Äì Emma hat eine Decke geh√§kelt, und dazu noch Rosen gemacht!\n\nModerator 2: Die Frau hat's drauf ‚Äì warm und sch√∂n gleichzeitig!" },
            { id: 16, name: "Jonathan", script: "Moderator 1: Das Lowboard von Jonathan ist so niedrig...\n\nModerator 2: ...wie das Niveau unserer Witze! üòÇ\n\nModerator 1: Aber hey, sieht gut aus ‚Äì und man kann nix mehr drunter verlieren!\n\nModerator 2: Praktisch UND cool ‚Äì gef√§llt mir!" },
            { id: 17, name: "Gerlach", script: "Moderator 1: St√§ndig dem Ball hinterherlaufen nervt, oder?\n\nModerator 2: Total!\n\nModerator 1: Gerlach hat das Problem gel√∂st ‚Äì mit seinem selbstgebauten Rebounder!\n\nModerator 2: Endlich kommt der Ball von allein zur√ºck ‚Äì mein Traum!" },
            { id: 18, name: "Salomon", script: "Moderator 1: Salomon wollte schon immer zum Mond.\n\nModerator 2: Dann hat er einfach seine eigene Rakete gebaut!\n\nModerator 1: Aus Pappe, Bauschaum und ner Plastikflasche ‚Äì DIY at its best.\n\nModerator 2: Ich hoffe nur, die startet nicht in der Turnhalle!" },
            { id: 19, name: "Milena", script: "Moderator 1: Milena liest gern, aber dicke B√ºcher? Eher nicht.\n\nModerator 2: Deswegen hat sie 16 Kurzgeschichten geschrieben ‚Äì kurz, spannend und perfekt f√ºrs Sofa.\n\nModerator 1: Ich sag's dir, das wird noch Bestseller-Material!\n\nModerator 2: Dann will ich aber eine signierte Ausgabe!" },
            { id: 20, name: "Benedikt", script: "Moderator 1: Wenn man die V√∂gel nicht findet...\n\nModerator 2: ...dann baut man ihnen halt ein Zuhause!\n\nModerator 1: Benedikt hat ein richtig sch√∂nes Vogelhaus gebaut.\n\nModerator 2: Airbnb f√ºr Spatzen ‚Äì sehr nachhaltig!" },
            { id: 21, name: "Karin", script: "Moderator 1: Kein Outfit passt?\n\nModerator 2: Dann n√§h dir halt eins ‚Äì so wie Karin!\n\nModerator 1: Ihr Outfit ist komplett selbstgemacht ‚Äì und sieht mega aus.\n\nModerator 2: Fashion-Queen, ganz klar!" },
            { id: 22, name: "Angelika", script: "Moderator 1: Batman kennst du, oder?\n\nModerator 2: Klar! Aber Angelikas Version ist sogar besser.\n\nModerator 1: Sie hat ihren eigenen Comic gemacht ‚Äì mit Humor, Action und Style.\n\nModerator 2: Also quasi Superheldin hinterm Zeichenblock!" },
            { id: 23, name: "Lamies", script: "Moderator 1: Kein Kleid gefunden?\n\nModerator 2: Dann mach dein eigenes!\n\nModerator 1: Genau das hat Lamies gemacht ‚Äì ein Ballkleid gen√§ht, das richtig was hermacht!\n\nModerator 2: Ich sag's dir, das ist rotteppichreif!" },
            { id: 24, name: "Oskar", script: "Moderator 1: Oskar hat mal wieder gebastelt ‚Äì aus Autoteilen!\n\nModerator 2: Moment, Deko aus Autoteilen?\n\nModerator 1: Ja! Recycling trifft auf Design ‚Äì sieht echt cool aus.\n\nModerator 2: Dann ist das wohl die einzige Sto√üstange, die ich ins Zimmer stellen w√ºrde!" },
            { id: 25, name: "Magdalena", script: "Moderator 1: Keramik ist teuer, oder?\n\nModerator 2: Kommt drauf an, wo du's kaufst ‚Äì oder ob du's selbst machst!\n\nModerator 1: Genau das hat Magdalena gemacht ‚Äì und richtig sch√∂ne St√ºcke gezaubert.\n\nModerator 2: Handmade und mega edel ‚Äì Daumen hoch!" },
            { id: 26, name: "Constantin", script: "Moderator 1: Constantin muss immer zum Tennistraining ‚Äì aber wie?\n\nModerator 2: Mit Stil nat√ºrlich!\n\nModerator 1: Deshalb hat er sein Mountainbike restauriert ‚Äì jetzt ist's schneller als je zuvor.\n\nModerator 2: Ich sag dir, Tour de France kann kommen!" },
            { id: 27, name: "Emil", script: "Moderator 1: Emil hatte Langeweile...\n\nModerator 2: ...also hat er einfach eine Boulderwand gebaut!\n\nModerator 1: Perfekt zum Klettern und Austoben.\n\nModerator 2: Ich w√ºrd ja mitmachen, aber meine Arme sagen nein." },
            { id: 28, name: "Zoe", script: "Moderator 1: Schmuck ist teuer, oder?\n\nModerator 2: Joa, wenn man ihn kauft schon ‚Äì Zoe macht ihn einfach selbst!\n\nModerator 1: Glitzer, Stil und Kreativit√§t in einem ‚Äì DIY vom Feinsten.\n\nModerator 2: Ich bestell schon mal eins f√ºr meine Mutter!" },
            { id: 29, name: "Anna", script: "Moderator 1: Kennst du Picasso?\n\nModerator 2: Nur vom Namen ‚Äì aber ich kenn Annas Gem√§lde!\n\nModerator 1: Eigen, farbenfroh, k√ºnstlerisch ‚Äì einfach Kunst mit Pers√∂nlichkeit.\n\nModerator 2: Ich w√ºrd's mir direkt ins Zimmer h√§ngen." },
            { id: 30, name: "Enio", script: "Moderator 1: Enio hat sich mit Van Gogh besch√§ftigt ‚Äì und selbst gemalt!\n\nModerator 2: Sonnenblumen inklusive?\n\nModerator 1: Nat√ºrlich ‚Äì und ganz viel Kreativit√§t obendrauf.\n\nModerator 2: Das ist Kunst mit Herz ‚Äì oder besser: mit Pinsel!" },
            { id: 31, name: "Estella", script: "Moderator 1: Estella hatte eine Mission: Sicherheit f√ºr alle!\n\nModerator 2: Und deswegen hat sie ein Selbstverteidigungsbuch geschrieben.\n\nModerator 1: Stark, mutig und mega wichtig ‚Äì da steckt Power drin.\n\nModerator 2: Also ich f√ºhl mich jetzt schon sicherer!" },
            { id: 32, name: "Elias", script: "Noch kein Script vorhanden..." },
            { id: 33, name: "Felix", script: "Moderator 1: Felix spielt seit sechs Jahren Gitarre ‚Äì aber einfach spielen reicht ihm nicht.\n\nModerator 2: Nee, er hat sich gleich eine E-Gitarre selbst gebaut!\n\nModerator 1: Rock'n'Roll pur!\n\nModerator 2: Wenn er jetzt noch spielt, fliegen die Noten durchs Dach!" },
            { id: 34, name: "Hugo", script: "Moderator 1: Schach ist zu langweilig?\n\nModerator 2: Nicht mit Hugo!\n\nModerator 1: Der hat n√§mlich sein eigenes Schachbrett gebaut ‚Äì richtig schick.\n\nModerator 2: Und wer verliert, muss aufr√§umen!" },
            { id: 35, name: "Said", script: "Moderator 1: Durst?\n\nModerator 2: Immer!\n\nModerator 1: Dann geh zu Said ‚Äì der hat eine Bar aus Paletten gebaut!\n\nModerator 2: Nachhaltig, cool und perfekt f√ºr jede Gartenparty." },
            { id: 36, name: "Illias Baskici", script: "Moderator 1: Pizza bestellen war gestern!\n\nModerator 2: Illias hat seinen eigenen Pizzaofen gebaut!\n\nModerator 1: Ich riech's schon, das ist Italien pur!\n\nModerator 2: Jetzt fehlt nur noch der Lieferservice!" },
            { id: 37, name: "Marie", script: "Moderator 1: Marie hat sich eine Katze geholt.\n\nModerator 2: Awww! Und was braucht die?\n\nModerator 1: Einen Kratzbaum nat√ºrlich ‚Äì den hat Marie selbst gebaut!\n\nModerator 2: Stylisch, stabil und katzengepr√ºft ‚Äì miauu!" }
        ];

        // Datenstruktur
        let persons = [];
        let folders = [];
        let currentEditId = null;
        let currentMode = 'normal';
        let currentFolderId = null;
        let currentAudioPersonId = null;
        let mediaRecorder = null;
        let audioChunks = [];
        let currentFolderSelectionPersonId = null;
        let selectedFoldersForPerson = [];

        // Initialisierung
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            setupAudioRecording();
            showTXTPreview();
        });

        // ==================== TXT EXPORT/IMPORT FUNKTIONEN ====================

        // Als TXT exportieren
        function exportToTXT() {
            let txtContent = "=== MODERATION SCRIPTS EXPORT ===\n";
            txtContent += `Exportiert am: ${new Date().toLocaleString()}\n`;
            txtContent += `Anzahl Personen: ${persons.length}\n`;
            txtContent += "=".repeat(50) + "\n\n";
            
            persons.forEach((person, index) => {
                txtContent += `PERSON ${index + 1}:\n`;
                txtContent += `Name: ${person.name}\n`;
                txtContent += `Script:\n${person.script}\n`;
                
                // Ordner zu dieser Person
                const personFolders = folders.filter(folder => 
                    folder.personIds.includes(person.id)
                ).map(folder => folder.name);
                
                if (personFolders.length > 0) {
                    txtContent += `Ordner: ${personFolders.join(', ')}\n`;
                }
                
                txtContent += "-".repeat(30) + "\n\n";
            });
            
            // Ordner-Liste
            txtContent += "=== ORDNER ===\n";
            folders.forEach(folder => {
                txtContent += `üìÅ ${folder.name} (${folder.personIds.length} Personen)\n`;
            });
            
            const blob = new Blob([txtContent], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `moderation-scripts_${new Date().toISOString().split('T')[0]}.txt`;
            link.click();
            
            alert('‚úÖ TXT-Datei wurde erstellt!');
        }

        // Von TXT importieren
        function importFromTXT() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.txt';
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const txtContent = e.target.result;
                        if (confirm('M√∂chtest du die aktuellen Daten mit der TXT-Datei ersetzen? Achtung: Alle aktuellen Daten gehen verloren!')) {
                            parseTXTData(txtContent);
                        }
                    } catch (error) {
                        alert('Fehler beim Import: ' + error.message);
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // TXT-Daten parsen
        function parseTXTData(txtContent) {
            try {
                const lines = txtContent.split('\n');
                const newPersons = [];
                let currentPerson = null;
                
                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i].trim();
                    
                    if (line.startsWith('PERSON')) {
                        if (currentPerson) {
                            newPersons.push(currentPerson);
                        }
                        currentPerson = { id: Date.now() + i, name: '', script: '' };
                    } else if (line.startsWith('Name:') && currentPerson) {
                        currentPerson.name = line.replace('Name:', '').trim();
                    } else if (line === 'Script:' && currentPerson) {
                        // Sammle das Script bis zur n√§chsten Sektion
                        let scriptLines = [];
                        let j = i + 1;
                        while (j < lines.length && !lines[j].includes('---') && !lines[j].startsWith('PERSON') && !lines[j].startsWith('===')) {
                            if (lines[j].trim()) {
                                scriptLines.push(lines[j]);
                            }
                            j++;
                        }
                        currentPerson.script = scriptLines.join('\n').trim();
                        i = j - 1;
                    }
                }
                
                // Letzte Person hinzuf√ºgen
                if (currentPerson && currentPerson.name) {
                    newPersons.push(currentPerson);
                }
                
                if (newPersons.length > 0) {
                    persons = newPersons;
                    saveData();
                    renderNamesList();
                    showTXTPreview();
                    alert(`‚úÖ ${newPersons.length} Personen aus TXT importiert!`);
                } else {
                    alert('‚ùå Keine Personen in der TXT-Datei gefunden!');
                }
            } catch (error) {
                alert('Fehler beim Parsen der TXT-Datei: ' + error.message);
            }
        }

        // TXT-Vorschau anzeigen
        function showTXTPreview() {
            const preview = document.getElementById('txt-preview');
            let previewContent = "=== VORSCHAU ===\n\n";
            
            // Zeige nur die ersten 3 Personen in der Vorschau
            const previewPersons = persons.slice(0, 3);
            
            previewPersons.forEach((person, index) => {
                previewContent += `${person.name}:\n`;
                const shortScript = person.script.length > 100 
                    ? person.script.substring(0, 100) + '...' 
                    : person.script;
                previewContent += `${shortScript}\n\n`;
            });
            
            if (persons.length > 3) {
                previewContent += `... und ${persons.length - 3} weitere Personen\n`;
            }
            
            previewContent += `\nGesamt: ${persons.length} Personen`;
            preview.textContent = previewContent;
        }

        // ==================== BESTEHENDE FUNKTIONEN (gek√ºrzt) ====================

        // Modus wechseln
        function switchMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const sidebar = document.getElementById('sidebar');
            const normalControls = document.getElementById('normal-controls');
            const folderControls = document.getElementById('folder-controls');
            const contentTitle = document.getElementById('content-title');
            const instructions = document.getElementById('mode-instructions');
            
            if (mode === 'folder') {
                sidebar.style.display = 'block';
                normalControls.style.display = 'none';
                folderControls.style.display = 'block';
                contentTitle.textContent = 'Personen im Ordner';
                instructions.textContent = '‚Ä¢ W√§hle einen Ordner ‚Ä¢ Markiere Personen ‚Ä¢ Verschiebe mit Buttons';
                showAllFolders();
            } else {
                sidebar.style.display = 'none';
                normalControls.style.display = 'block';
                folderControls.style.display = 'none';
                contentTitle.textContent = 'Personen';
                instructions.textContent = '‚Ä¢ Klicke auf Namen f√ºr Scripts ‚Ä¢ Bearbeiten mit ‚úé ‚Ä¢ Reihenfolge mit üî¢ ‚Ä¢ Ordner mit üìÅ';
            }
            renderNamesList();
        }

        // Alle Ordner anzeigen
        function showAllFolders() {
            currentFolderId = null;
            document.getElementById('content-title').textContent = 'Alle Ordner';
            renderFolders();
            renderNamesList();
        }

        // Ordner erstellen
        function createFolder() {
            const nameInput = document.getElementById('folder-name-input');
            const name = nameInput.value.trim();
            
            if (!name) {
                alert('Bitte gib einen Ordnernamen ein!');
                return;
            }
            
            const newFolder = {
                id: Date.now(),
                name: name,
                personIds: []
            };
            
            folders.push(newFolder);
            saveData();
            renderFolders();
            nameInput.value = '';
            alert('Ordner erstellt!');
        }

        // Ordner rendern
        function renderFolders() {
            const foldersList = document.getElementById('folders-list');
            
            if (folders.length === 0) {
                foldersList.innerHTML = '<div class="empty-message">Noch keine Ordner</div>';
                return;
            }
            
            foldersList.innerHTML = folders.map(folder => `
                <div class="folder ${currentFolderId === folder.id ? 'active' : ''}" 
                     onclick="selectFolder(${folder.id})">
                    <div class="folder-header">
                        <div class="folder-name">üìÅ ${folder.name}</div>
                        <div class="folder-actions">
                            <button class="action-btn" onclick="event.stopPropagation(); deleteFolder(${folder.id})">√ó</button>
                        </div>
                    </div>
                    <div class="folder-item-count">${folder.personIds.length} Personen</div>
                </div>
            `).join('');
        }

        // Zu Ordner hinzuf√ºgen
        function addToFolder(personId) {
            currentFolderSelectionPersonId = personId;
            selectedFoldersForPerson = [];
            
            const folderSelection = document.getElementById('folder-selection');
            folderSelection.innerHTML = folders.map(folder => `
                <div class="folder-option" onclick="toggleFolderSelection(${folder.id})" id="folder-opt-${folder.id}">
                    <div class="folder-name">üìÅ ${folder.name}</div>
                    <div class="folder-item-count">${folder.personIds.length} Personen</div>
                </div>
            `).join('');
            
            document.getElementById('folder-modal-title').textContent = `"${persons.find(p => p.id === personId).name}" zu Ordnern hinzuf√ºgen`;
            document.getElementById('folder-modal').style.display = 'block';
            document.getElementById('folder-modal-overlay').style.display = 'block';
        }

        // Namenliste rendern
        function renderNamesList() {
            const namesList = document.getElementById('names-list');
            updatePersonCount();
            
            let displayPersons = persons;
            
            if (currentMode === 'folder' && currentFolderId) {
                const folder = folders.find(f => f.id === currentFolderId);
                displayPersons = persons.filter(p => folder.personIds.includes(p.id));
            }
            
            if (displayPersons.length === 0) {
                namesList.innerHTML = '<div class="empty-message">Noch keine Personen vorhanden</div>';
                return;
            }

            namesList.innerHTML = displayPersons.map((person, index) => `
                <div class="name-item ${person.selected ? 'selected' : ''}" 
                     data-id="${person.id}" 
                     onclick="${currentMode === 'folder' ? `toggleSelect(${person.id})` : `showScript(${person.id})`}">
                    <div class="name-item-number">${index + 1}</div>
                    <div class="name-item-content">
                        <span class="name-text">${person.name}</span>
                        <div class="name-actions">
                            ${currentMode === 'folder' ? `
                                <button class="action-btn" onclick="event.stopPropagation(); showScript(${person.id})">üëÅÔ∏è</button>
                            ` : `
                                <button class="action-btn" onclick="event.stopPropagation(); changeOrder(${person.id})">üî¢</button>
                                <button class="action-btn" onclick="event.stopPropagation(); editPerson(${person.id})">‚úé</button>
                                <button class="action-btn" onclick="event.stopPropagation(); addToFolder(${person.id})">üìÅ</button>
                            `}
                            <button class="action-btn" onclick="event.stopPropagation(); deletePerson(${person.id})">√ó</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Weitere Funktionen (gek√ºrzt dargestellt)
        function loadFromLocalStorage() {
            const localData = localStorage.getItem('moderationPersons');
            const folderData = localStorage.getItem('moderationFolders');
            
            if (localData) {
                persons = JSON.parse(localData);
            } else {
                persons = JSON.parse(JSON.stringify(DEFAULT_EXCEL_DATA));
            }
            
            if (folderData) {
                folders = JSON.parse(folderData);
            }
            
            renderNamesList();
        }

        function saveData() {
            localStorage.setItem('moderationPersons', JSON.stringify(persons));
            localStorage.setItem('moderationFolders', JSON.stringify(folders));
            showTXTPreview();
        }

        // ... (alle anderen Funktionen bleiben gleich)

    </script>
</body>
</html>